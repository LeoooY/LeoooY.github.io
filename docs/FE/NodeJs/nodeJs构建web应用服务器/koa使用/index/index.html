<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.62">
<title data-react-helmet="true">index | DocsShare</title><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="index | DocsShare"><meta data-react-helmet="true" name="description" content="- 安装"><meta data-react-helmet="true" property="og:description" content="- 安装"><meta data-react-helmet="true" property="og:url" content="https://leoooy.github.io//docs/FE/NodeJs/nodeJs构建web应用服务器/koa使用/index"><link data-react-helmet="true" rel="shortcut icon" href="/img/leo.png"><link data-react-helmet="true" rel="canonical" href="https://leoooy.github.io//docs/FE/NodeJs/nodeJs构建web应用服务器/koa使用/index"><link rel="stylesheet" href="/styles.fcc05d64.css">
<link rel="preload" href="/styles.da09b0aa.js" as="script">
<link rel="preload" href="/runtime~main.fcea67fc.js" as="script">
<link rel="preload" href="/main.2f1d5848.js" as="script">
<link rel="preload" href="/1.f45b894e.js" as="script">
<link rel="preload" href="/2.a477ba05.js" as="script">
<link rel="preload" href="/3.32e8b994.js" as="script">
<link rel="preload" href="/1be78505.89b8407a.js" as="script">
<link rel="preload" href="/171.d3ef19ea.js" as="script">
<link rel="preload" href="/935f2afb.43a6fc9a.js" as="script">
<link rel="preload" href="/17896441.30e2172e.js" as="script">
<link rel="preload" href="/fcfa75a2.0a23e490.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/leo.png" alt="My Site Logo"><strong class="navbar__title">My DocsShare</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Notes</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LeoooY" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://juejin.im/user/5bebc171e51d4511a8090edb/posts" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">掘金</a><a href="https://twitter.com/LeoY233" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Twitter</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/leo.png" alt="My Site Logo"><strong class="navbar__title">My DocsShare</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs">Notes</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/LeoooY" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://juejin.im/user/5bebc171e51d4511a8090edb/posts" target="_blank" rel="noopener noreferrer" class="menu__link">掘金</a></li><li class="menu__list-item"><a href="https://twitter.com/LeoY233" target="_blank" rel="noopener noreferrer" class="menu__link">Twitter</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><div><span class="badge badge--secondary">Version: Next</span></div><header><h1 class="docTitle_1Lrw">index</h1></header><div class="markdown"><ul><li><a href="#%E5%AE%89%E8%A3%85">安装</a></li><li><a href="#%E7%89%B9%E7%82%B9">特点</a></li><li><a href="#%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8">使用入门</a></li><li><a href="#"></a><ul><li><a href="#applisten">app.listen()</a></li><li><a href="#appcallback">app.callback()</a></li><li><a href="#appusefunc-aysnc-func">app.use(func| aysnc func)</a></li><li><a href="#appkeys">app.keys=</a></li><li><a href="#appcontext">app.context</a></li></ul></li><li><a href="#context-ctx"><code>Context</code> <code>ctx</code></a><ul><li><a href="#ctx-api"><code>ctx api</code></a><ul><li><a href="#ctxreq"><code>ctx.req</code></a></li><li><a href="#ctxres"><code>ctx.res</code></a></li><li><a href="#ctxrequest"><code>ctx.request</code></a></li><li><a href="#ctxresponse"><code>ctx.response</code></a></li><li><a href="#ctxstate"><code>ctx.state</code></a></li><li><a href="#ctxapp"><code>ctx.app</code></a></li><li><a href="#ctxappemit"><code>ctx.app.emit</code></a></li><li><a href="#ctxcookiesgetname-options"><code>ctx.cookies.get(name, [options])</code></a></li><li><a href="#ctxcookiessetname-value-options"><code>ctx.cookies.set(name, value, [options])</code></a></li><li><a href="#ctxthrowstatus-msg-properties"><code>ctx.throw([status], [msg], [properties])</code></a></li><li><a href="#ctxassertvalue-status-msg-properties"><code>ctx.assert(value, [status], [msg], [properties])</code></a></li><li><a href="#xctxrespond">[x]<code>ctx.respond</code></a></li></ul></li><li><a href="#request">Request</a></li><li><a href="#response">Response</a></li></ul></li><li><a href="#%E5%B8%B8%E7%94%A8midware">常用<code>midware</code></a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="安装"></a>安装<a aria-hidden="true" tabindex="-1" class="hash-link" href="#安装" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">npm i koa</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="特点"></a>特点<a aria-hidden="true" tabindex="-1" class="hash-link" href="#特点" title="Direct link to heading">#</a></h3><ul><li><code>array of middleware functions</code></li><li><code>stack-like manner</code> 先进后出</li><li><code>async functions</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="使用入门"></a>使用入门<a aria-hidden="true" tabindex="-1" class="hash-link" href="#使用入门" title="Direct link to heading">#</a></h3><h3></h3><blockquote><p>When a middleware invokes <code>next()</code> the function <strong>suspends and passes control to the next middleware</strong> defined. After there are <strong>no more middleware</strong> to execute downstream, the stack will <strong>unwind</strong> and each middleware is <strong>resumed</strong> to perform its upstream behaviour.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">app.use(async (ctx, next) =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    const start = Date.now();</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div></blockquote><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">await next();       // 执行到此被阻塞，执行交给栈中下一个中间件</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    // 直到所有中间件await之前的部分都执行完成（或者中间件没有await）</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    // 按栈的顺序（先进后出）继续执行await之后的代码</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">const ms = Date.now() - start;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ctx.set(&#x27;X-Response-Time&#x27;, `${ms}ms`);</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>});</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#### app.listen()</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>const Koa = require(&#x27;koa&#x27;);
const app = new Koa();
app.listen(3000);</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">is suger to</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>const http = require(&#x27;http&#x27;);
const Koa = require(&#x27;koa&#x27;);
const app = new Koa();
http.createServer(app.callback()).listen(3000);</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">eg:</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>const http = require(&#x27;http&#x27;);
const https = require(&#x27;https&#x27;);
const Koa = require(&#x27;koa&#x27;);
const app = new Koa();
http.createServer(app.callback()).listen(3000);
https.createServer(app.callback()).listen(3001);</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#### app.callback()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;Return a callback function suitable for the http.createServer() method to handle a request. You may also use this callback function to mount your Koa app in a Connect/Express app.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#### app.use(func| aysnc func)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;Add the given middleware function to this application. See Middleware for more information.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#### app.keys=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Set signed cookie keys.</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>app.keys = [&#x27;im a newer secret&#x27;, &#x27;i like turtle&#x27;];
app.keys = new KeyGrip([&#x27;im a newer secret&#x27;, &#x27;i like turtle&#x27;], &#x27;sha256&#x27;);</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#### app.context</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;`app.context` is the prototype from which `ctx` is created. You may add additional properties to `ctx` by editing `app.context`. This is useful for adding properties or methods to ctx to be used across your entire app, which may be more performant (no middleware) and/or easier (fewer require()s) at the expense of relying more on ctx, which could be considered an anti-pattern.</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>app.context.db = db();</p><p>app.use(async ctx =&gt; {
console.log(ctx.db);
});</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Note:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- Many properties on ctx are defined using getters, setters, and Object.defineProperty(). You can only edit these properties (not recommended) by using Object.defineProperty() on app.context. See https://github.com/koajs/koa/issues/652.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- Mounted apps currently use their parent&#x27;s ctx and settings. Thus, mounted apps are really just groups of middleware.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">### `Context` `ctx`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;A Koa Context encapsulates node&#x27;s `request` and `response` objects into a single object which provides many helpful methods for writing web applications and APIs.</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>app.use(async ctx =&gt; {
ctx; // is the Context
ctx.request; // is a Koa Request
ctx.response; // is a Koa Response
});</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;**Many of the context&#x27;s accessors and methods simply delegate to their ctx.request or ctx.response equivalents for convenience**, and are otherwise identical. For example ctx.type and ctx.length delegate to the response object, and ctx.path and ctx.method delegate to the request.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#### `ctx api`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##### `ctx.req`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Node&#x27;s request object.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##### `ctx.res`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Node&#x27;s response object.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Bypassing Koa&#x27;s response handling is not supported. Avoid using the following node properties:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- res.statusCode</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- res.writeHead()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- res.write()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- res.end()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##### `ctx.request`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">A Koa Request object.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##### `ctx.response`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">A Koa Response object.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##### `ctx.state`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">The recommended namespace for passing information through middleware and to your frontend views.</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>ctx.state.user = await User.find(id);</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">##### `ctx.app`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Application instance reference.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##### `ctx.app.emit`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;Koa applications extend an internal `EventEmitter`. ctx.app.emit emits an event with a type, defined by the first argument. For each event you can hook up &quot;listeners&quot;, which is a function that is called when the event is emitted. Consult the error handling docs for more information.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##### `ctx.cookies.get(name, [options])`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##### `ctx.cookies.set(name, value, [options])`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##### `ctx.throw([status], [msg], [properties])`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Helper method to throw an error with a .status property defaulting to 500 that will allow Koa to respond appropriately. The following combinations are allowed:</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>ctx.throw(400);
ctx.throw(400, &#x27;name required&#x27;);
ctx.throw(400, &#x27;name required&#x27;, { user: user });</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">`ctx.throw(400, &#x27;name required&#x27;)` is equivalent to</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>const err = new Error(&#x27;name required&#x27;);
err.status = 400;
err.expose = true;
throw err;</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">##### `ctx.assert(value, [status], [msg], [properties])`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">##### [x]`ctx.respond`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Using this property is considered a **hack** and is only a convenience to those wishing to use traditional fn(req, res) functions and middleware within Koa.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#### Request</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>request.header / request.headers
request.method
request.url
request.href
request.query
request.querystring
request.search
request.host
request.fresh / request.stale
request.protocol
request.secure  //ctx.protocol == &quot;https&quot;
request.ip
request.ips  //When X-Forwarded-For is present and app.proxy is enabled an array of these ips is returned, ordered from upstream -&gt; downstream. When disabled an empty array is returned.
request.is(types...)
request.accepts(types)
request.acceptsEncodings(encodings)
request.acceptsCharsets(charsets)
request.acceptsLanguages(langs)
request.socket      //Return the request socket.
request.get(field)  //Return request header.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#### Response</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>response.header / response.headers
response.status / response.status=
response.message / response.message=
response.length / response.length=</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;ul&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;100 &quot;continue&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;101 &quot;switching protocols&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;102 &quot;processing&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;200 &quot;ok&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;201 &quot;created&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;202 &quot;accepted&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;203 &quot;non-authoritative information&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;204 &quot;no content&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;205 &quot;reset content&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;206 &quot;partial content&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;207 &quot;multi-status&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;208 &quot;already reported&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;226 &quot;im used&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;300 &quot;multiple choices&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;301 &quot;moved permanently&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;302 &quot;found&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;303 &quot;see other&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;304 &quot;not modified&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;305 &quot;use proxy&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;307 &quot;temporary redirect&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;308 &quot;permanent redirect&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;400 &quot;bad request&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;401 &quot;unauthorized&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;402 &quot;payment required&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;403 &quot;forbidden&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;404 &quot;not found&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;405 &quot;method not allowed&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;406 &quot;not acceptable&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;407 &quot;proxy authentication required&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;408 &quot;request timeout&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;409 &quot;conflict&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;410 &quot;gone&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;411 &quot;length required&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;412 &quot;precondition failed&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;413 &quot;payload too large&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;414 &quot;uri too long&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;415 &quot;unsupported media type&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;416 &quot;range not satisfiable&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;417 &quot;expectation failed&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;418 &quot;I&#x27;m a teapot&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;422 &quot;unprocessable entity&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;423 &quot;locked&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;424 &quot;failed dependency&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;426 &quot;upgrade required&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;428 &quot;precondition required&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;429 &quot;too many requests&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;431 &quot;request header fields too large&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;500 &quot;internal server error&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;501 &quot;not implemented&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;502 &quot;bad gateway&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;503 &quot;service unavailable&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;504 &quot;gateway timeout&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;505 &quot;http version not supported&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;506 &quot;variant also negotiates&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;507 &quot;insufficient storage&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;508 &quot;loop detected&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;510 &quot;not extended&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;511 &quot;network authentication required&quot;&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/ul&gt;</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>response.body / response.body=</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;ul&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;&lt;code&gt;string&lt;/code&gt; written&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;&lt;code&gt;Buffer&lt;/code&gt; written&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;&lt;code&gt;Stream&lt;/code&gt; piped&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;&lt;code&gt;Object&lt;/code&gt; || &lt;code&gt;Array&lt;/code&gt; json-stringified&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;li&gt;&lt;code&gt;null&lt;/code&gt; no content response&lt;/li&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/ul&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">koa with createReadStream</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>const filedir=&#x27;/xx/ss/ss.json&#x27;</p><p>ctx.type = path.extname(filedir)
ctx.body=fs.createReadStream(filedir)</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>response.get(field)
response.set(field, value)
response.append(field, value)
response.set(fields)
response.remove(field)</p><p>response.type / response.type=
response.redirect(url, [alt])
response.lastModified / response.lastModified=
response.flushHeaders() // Flush any set headers, and begin the body.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">------------------------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">### 常用`midware`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- #### [`koa-compose`](https://github.com/koajs/compose)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;compose several middleware into one</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">`install`</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>npm install koa-compose</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">`use`</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>// a,b,c is koa middware functions
compose([a, b, c, ...])</p><p>//return a koa middware functions can be used directly</p><p>const mid=compose([a,b])
...
app.use(mid)</p><div class="mdxCodeBlock_1XEh"><code></code></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#安装" class="table-of-contents__link">安装</a></li><li><a href="#特点" class="table-of-contents__link">特点</a></li><li><a href="#使用入门" class="table-of-contents__link">使用入门</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div>Copyright © 2020 LeoY233. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.da09b0aa.js"></script>
<script src="/runtime~main.fcea67fc.js"></script>
<script src="/main.2f1d5848.js"></script>
<script src="/1.f45b894e.js"></script>
<script src="/2.a477ba05.js"></script>
<script src="/3.32e8b994.js"></script>
<script src="/1be78505.89b8407a.js"></script>
<script src="/171.d3ef19ea.js"></script>
<script src="/935f2afb.43a6fc9a.js"></script>
<script src="/17896441.30e2172e.js"></script>
<script src="/fcfa75a2.0a23e490.js"></script>
</body>
</html>