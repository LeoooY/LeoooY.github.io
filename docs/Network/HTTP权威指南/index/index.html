<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.62">
<title data-react-helmet="true">index | DocsShare</title><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="index | DocsShare"><meta data-react-helmet="true" name="description" content="HTTP权威指南"><meta data-react-helmet="true" property="og:description" content="HTTP权威指南"><meta data-react-helmet="true" property="og:url" content="https://leoooy.github.io//docs/Network/HTTP权威指南/index"><link data-react-helmet="true" rel="shortcut icon" href="/img/leo.png"><link data-react-helmet="true" rel="canonical" href="https://leoooy.github.io//docs/Network/HTTP权威指南/index"><link rel="stylesheet" href="/styles.fcc05d64.css">
<link rel="preload" href="/styles.da09b0aa.js" as="script">
<link rel="preload" href="/runtime~main.872dded8.js" as="script">
<link rel="preload" href="/main.2f1d5848.js" as="script">
<link rel="preload" href="/1.f45b894e.js" as="script">
<link rel="preload" href="/2.a477ba05.js" as="script">
<link rel="preload" href="/3.b78202e8.js" as="script">
<link rel="preload" href="/1be78505.89b8407a.js" as="script">
<link rel="preload" href="/171.d3ef19ea.js" as="script">
<link rel="preload" href="/935f2afb.43a6fc9a.js" as="script">
<link rel="preload" href="/17896441.30e2172e.js" as="script">
<link rel="preload" href="/36faa5d6.be2c1bec.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/leo.png" alt="My Site Logo"><strong class="navbar__title">My DocsShare</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Notes</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LeoooY" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://juejin.im/user/5bebc171e51d4511a8090edb/posts" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">掘金</a><a href="https://twitter.com/LeoY233" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Twitter</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/leo.png" alt="My Site Logo"><strong class="navbar__title">My DocsShare</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs">Notes</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/LeoooY" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://juejin.im/user/5bebc171e51d4511a8090edb/posts" target="_blank" rel="noopener noreferrer" class="menu__link">掘金</a></li><li class="menu__list-item"><a href="https://twitter.com/LeoY233" target="_blank" rel="noopener noreferrer" class="menu__link">Twitter</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><div><span class="badge badge--secondary">Version: Next</span></div><header><h1 class="docTitle_1Lrw">index</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="http权威指南"></a>HTTP权威指南<a aria-hidden="true" tabindex="-1" class="hash-link" href="#http权威指南" title="Direct link to heading">#</a></h1><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第一部分-http"></a>第一部分 HTTP<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第一部分-http" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第一章-http概述"></a>第一章 HTTP概述<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第一章-http概述" title="Direct link to heading">#</a></h2><p>1.1 HTTP
1.2 web客户端和服务器
1.3 资源</p><ul><li><code>MIME</code>媒体类型</li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">MIME type</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    text/html</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    text/plain  普通的ASCII文本文档</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    image/jpeg  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    image/gif   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    video/quicktime Apple的视频格式</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    application/vnd.ms-powerpointer 微软的ppt格式     </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ......(附录D)</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><ul><li><code>URI</code> 统一资源标识符
<code>Uniform Resource Identifier</code>,定位服务器上的某一资源
如服务器上的一张图片:</li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">leoooy.site/demo.gif</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><ul><li><code>URL</code> 统一资源定位符
<code>Uniform Resource Location</code>, 描述获取某服务器上某资源的特定位置</li></ul><p>现在几乎所有的URI都是URL
URL由三部分组成：
协议,如<code>http</code>、<code>https</code>
域名，如<code>leoooy.site</code>
位置，如<code>/api/getData</code></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">http://leoooy.site/api/getData</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><ul><li><code>URN</code> 统一资源名，URI的另一种形式
实验阶段，可以用同一个名字通过多种网络协议来访问资源</li></ul><blockquote><p>一般来说不太区分URI和URL</p></blockquote><p>1.4 事务
一个HTTP事务由一条请求命令和一个响应结果组成，通信通过HTTP报文的格式化数据块进行的。</p><ul><li>方法</li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">GET 从服务器向客户端发送资源</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PUT 将来自客户端的数据存储到服务器中</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DELETE 删除服务器中的资源</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">POST # The POST method is used to submit an entity to the specified resource, often causing a change in state or side effects on the server.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">HEAD 仅发送HTTP首部</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><ul><li>状态码</li></ul><p>1.5 报文</p><p>1.6 连接
基于TCP/IP</p><p>1.7 协议版本</p><p>HTTP/0.9
HTTP/1.0
HTTP/1.0+
HTTP/1.1</p><p>HTTP/2（HTTP-NG）
HTTP/3</p><p>1.8 Web的结构组价
代理
代表用户发送请求</p><p>缓存</p><p>网关
作为服务器的中间实体，通常用于转换协议，如http转ftp</p><p>隧道
在隧道之间进行盲转发，转发时不会窥探数据
http隧道的常见用途是 SSL/TLS</p><p>Agent代理
爬虫常用，伪装user-agent    </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第二章-url与资源"></a>第二章 URL与资源<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第二章-url与资源" title="Direct link to heading">#</a></h2><p>2.1 网络上的资源
2.2 URL的语法
协议
主机与端口
*用户名与密码 <code>http://uname:pwd@www.baidu.com/xx</code> <code>ftp://uname:pwd@www.baidu.com/xx</code>
资源路径
参数 /api1;type=1
查询字符串 queryString ?a=1
锚点(仅作用于客户端)   /index.html#p1</p><p>2.3 URL快捷方式</p><p>2.3.1 相对URL
2.3.2 自动扩展URL（浏览器处理）</p><p>2.4 各种字符
URL字符集
编码机制</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第三章-http报文"></a>第三章 HTTP报文<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第三章-http报文" title="Direct link to heading">#</a></h2><p>3.1 报文流
3.2 报文的组成
报文的语法
起始行
首部（通用首部，请求首部，响应首部，实体首部，扩展首部）
实体的主体
3.3 方法</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第四章-连接管理"></a>第四章 连接管理<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第四章-连接管理" title="Direct link to heading">#</a></h2><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第二部分-http的结构"></a>第二部分 HTTP的结构<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第二部分-http的结构" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第五章-web服务器结构"></a>第五章 web服务器结构<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第五章-web服务器结构" title="Direct link to heading">#</a></h2><p>5.52 web服务器结构</p><ul><li>单线程web服务器</li><li>多进程及多线程web服务器</li><li>复用I/O的web服务器</li><li>复用的多线程web服务器</li></ul><p>接受客户端连接
接收请求报文
处理请求
对于资源映射的访问
构建响应
发送响应
记录日志</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第六章-http代理服务器"></a>第六章 http代理服务器<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第六章-http代理服务器" title="Direct link to heading">#</a></h2><ul><li>文档访问控制</li><li>儿童保护</li><li>安全防火墙</li><li>web代理缓存(cdn)</li><li>反向代理</li><li>内容路由器</li><li>转码器</li></ul><p>代理服务器的部署</p><ul><li>出口代理</li><li>入口代理</li><li>反向代理</li><li>网络交换代理</li></ul><p>代理的层次结构
报文从一个代理传到另一个代理，直到最终抵达原始服务器
多层代理</p><p>代理层次结构的内容路由</p><ul><li>负载均衡</li><li>地理位置附近的路由</li><li>协议/类型路由</li><li>基于订购(付费)的路由： 会员用户的资源URI被转发到大型缓存或压缩引擎上</li></ul><p>代理如何截获请求（请求是如何经过代理的）</p><ul><li>修改客户端（浏览器代理）</li><li>修改网络（全局代理）</li><li>修改DNS（hosts）</li><li>修改web服务器（服务器重定向）</li></ul><p>客户端的代理设置</p><ul><li>手工配置（全局代理、浏览器代理）： 显式的设置要使用的代理</li><li>自动代理PAC(Proxy Auto-Configuration)</li><li>WPAD(Web Proxy Autodiscovery Protocal)有些浏览器支持web代理自动发现协议</li></ul><p>追踪报文</p><ul><li>via 首部</li><li>TRACE</li></ul><p>代理认证</p><p>代理的互操作性</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第七章-web缓存机制"></a>第七章 web缓存机制<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第七章-web缓存机制" title="Direct link to heading">#</a></h2><p>缓存解决的问题</p><ul><li>冗余的数据传输</li><li>带宽瓶颈</li><li>瞬间拥塞</li><li>距离时延</li></ul><p>缓存命中和未命中
可以用已有副本来为某些到达缓存的服务提供副本，被称为缓存命中。
相反的，称为缓存未命中，未命中的缓存被转发到原始服务器上重新请求</p><ul><li>再验证 revalidation</li><li>命中率 cache hit rate，缓存提供的服务的请求所占的比例</li><li>字节命中率 bite hit rate</li><li>判断来自CDN缓存还是原始服务器，两种状态码都是200ok,可以通过 via首部 Date首部 age首部来判断</li></ul><p>缓存的拓扑结构</p><ul><li>私有缓存（浏览器中有内建的私有缓存）</li><li>公有缓存
公有缓存是特殊的共享代理服务器，被称为缓存代理服务器（caching proxy server）或是代理缓存（proxy cache）</li></ul><p>代理缓存的层次结构</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">原始服务器 &gt; 广域网 &gt; 二级缓存 &gt; 地区性网络 &gt; 一级缓存 &gt; 客户端（第一级缓存命中）</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 我们希望用户都在一级缓存命中，如果没有命中，较大的父级缓存（这里对应二级缓存）可能能够处理它们的请求</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 如果浏览器自带缓存，那么这个就是一个三级缓存的结构</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 父级缓存可能还要更大一些，以便更多的装载必要的缓存，还有接收子缓存聚合的流量</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 实际应用中，网络结构会被限制在2到3个代理以内，不过新一代的高性能代理服务器会使得代理链的长度不那么重要</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>网状缓存</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">根据url在父缓存和原始服务器中进行动态选择</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">根据url动态选择一个特定的父缓存</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">前往父缓存之前，先在本地缓存中搜索已缓存的副本</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">允许缓存之间相互访问，但不允许外网流量访问其缓存（兄弟缓存）</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>缓存的处理步骤</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">接收</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">解析    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">查询    查看是否有本地副本可用，没有就重新请求并保存一份副本</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">新鲜度查询： 查看缓存副本是否已经过期，过期重新请求并缓存</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">创建响应： 新的首部和已缓存的主体来构建一条响应</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">发送</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">日志</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>缓存的新鲜度<code>server revalidation</code></p><ul><li>过期时间和使用期</li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cache-control: max-age</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Expiers: Fri, 05 Jul 2002, 05:00:00 GMT</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><ul><li>服务器再验证</li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">if-modified-since:&lt;date&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if-none-match:&lt;tags&gt;  &lt;=&gt;  Etag</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Etag的值和 if-none-match 不同，则回重新请求并更新Etag</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><ul><li>服务器控制缓存（响应首部）</li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cache-control: </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">no-store</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">no-cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">must-revalidate</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">max-age</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># no-store 和 no-cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Pragma: no-cahce       # 为了兼容http/1.0+，不兼容就不需要</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Cache-Control: no-store  # 禁止缓存此次响应，并删除已缓存的对象</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Cache-Control: no-cache  # 再验证之前不存储</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># max-age首部 和s-maxage</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Cache-Control: max-age=3600     # 单位是s秒    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Cache-Control: s-maxage=3600    # s-maxage仅仅适用于公有缓存</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                # 两个age=0，则是不使用缓存</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Expires首部（不推荐使用）</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">由于很多服务器时钟不同步或是不正确，所以实际可能不准确。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">通过计算过期日期和现在的差值，转换为max-age</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Expiers: Fri, 05 Jul 2002, 05:00:00 GMT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># must-recalidate响应首部 （response header）</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Cache-Control: must-revalidate # 告诉缓存严格遵守过期信息</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            # 事先没和服务器再验证的情况下，不得提供缓存的副本</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 试探性过期</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><ul><li>客户端控制缓存（请求首部）</li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Cache-Control: max-stale          # 缓存可以随意提供过期的文件</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Cache-Control: max-stale= &lt;s&gt;     # 缓存在s秒内绝不过期</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Cache-Control: min-feash= &lt;s&gt;     # 在s秒内不得缓存</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Cache-Control: max-age= &lt;s&gt;   # 大于s秒的缓存为过期，</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                              # 除非同时指定了max-stale</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Cache-Control: no-cache  # 再验证之前不使用缓存</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#Pragma: no-cache        兼容http/1.0+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Cache-Control: no-store  # 禁止缓存此次响应，并删除已缓存的文件</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Cache-Control: only-if-cached # 只有当缓存中有副本存在时，客户端才会获取一份副本</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><ul><li>缓存与广告
广告可以通过缓存更快，更好的展示，但是有些服务商是按访问次数计费，如果访问只到达缓存而不通过服务器则隐藏了实际的访问次数。
解决方案试将命中的缓存记录日志再发送到原始服务器
日志分发策略</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第八章-集成点：网关、隧道及中继"></a>第八章　集成点：网关、隧道及中继<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第八章-集成点：网关、隧道及中继" title="Direct link to heading">#</a></h2><ul><li>使用http访问其他协议的资源及</li><li>将http作为框架启动其他协议和应用程序通信</li></ul><p>8.1 网关
作为翻译器，将http请求翻译为其他协议</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 协议网关</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">http/ftp 网关           </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">http/https 网关</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 资源网关</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">http/CGI(应用程序服务器) 网关 # 或者其他API</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>8.5 隧道 web tunnel(web 隧道)
通过http协议访问非http协议的应用程序
（通过http流量发送非http流量）</p><p>用CONNECT方法建立HTTP隧道
SSL隧道：通过一条HTTP连接来传输SSL流量，以穿过80端口的http防火墙</p><p>SSL隧道和HTTP/HTTPS网关的对比</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 网关</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">客户端到网关的连接仍是不安全的HTTP</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">客户端只能认证网关，但不能对远端服务器进行SSL客户端认证</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>8.6 中继
HTTP中继（relay）是没有完全按照HTTP规范执行的简单HTTP代理
中继负责处理HTTP建立连接的部分，然后对字节进行盲转发
常见的问题：
无法处理connection首部的问题，所以有潜在的挂起keep-alive连接的可能</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第九章-web机器人（爬虫）"></a>第九章　web机器人（爬虫）<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第九章-web机器人（爬虫）" title="Direct link to heading">#</a></h2><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第十章-web技术的未来"></a>第十章　web技术的未来<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第十章-web技术的未来" title="Direct link to heading">#</a></h2><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第三部分-识别、认证与安全"></a>第三部分 识别、认证与安全<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第三部分-识别、认证与安全" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第十一章-客户端识别与cookie机制"></a>第十一章 客户端识别与cookie机制<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第十一章-客户端识别与cookie机制" title="Direct link to heading">#</a></h2><p>cookie</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">响应首部 set-cookie</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">请求首部 cookie</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第十二章-基本认证机制"></a>第十二章 基本认证机制<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第十二章-基本认证机制" title="Direct link to heading">#</a></h2><p>将用户名和密码通过base64编码传输到服务器，只能防止非恶意用户无意间进行的访问。
不能防止暴力破解、钓鱼网站、重放攻击和中间人攻击</p><p>一般将基本认证和HTTPS配合使用来变得更安全</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第十三章-摘要认证"></a>第十三章 摘要认证<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第十三章-摘要认证" title="Direct link to heading">#</a></h2><p>摘要认证之比基本认证强大一些，并没有HTTPS安全
将客户端的用户名和密码计算成一个摘要发送到服务器中，服务器取用户名和密码计算一个摘要和此摘要进行对比</p><p>用随机数防止重放攻击：服务器每次传一个随机数，在计算摘要之前加入用户名或密码</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第十四章-https"></a>第十四章 HTTPS<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第十四章-https" title="Direct link to heading">#</a></h2><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第四部分-实体、编码和国际化"></a>第四部分 实体、编码和国际化<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第四部分-实体、编码和国际化" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第十五章-实体和编码"></a>第十五章 实体和编码<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第十五章-实体和编码" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 正确的识别</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Type</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Language</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 正确的解包</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Length</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Encoding</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 是最新的</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Etag</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">缓存相关首部，参考缓存一章</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 符合用户的需求</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Accept系列的内容协商首部</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 在网络上可以快速的传输</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">范围请求、差异编码及数据压缩方法首部</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 完整到达，未被篡改</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">传输编码首部，Content-MD5校验和</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>内容编码</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 服务器响应首部</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Encoding: gzip,compress,delate,identity</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">gzip效率最高，使用最广泛</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 客户端请求首部</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Accept-Encoding: *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Accept-Encoding: compress,gzip</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Accept-Encoding: compress;q=1.0, gzip;q=0.5</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>可靠传输</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Transfer-Encoding</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>分块编码</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-length</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>范围请求</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">range: bytes=4000-</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第十六章-国际化"></a>第十六章 国际化<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第十六章-国际化" title="Direct link to heading">#</a></h2><p>国际化与字符集</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 客户端设置</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Accept-Language:  fr,en;q=0.8   # q是质量因子，表示优先级，最高是1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Accept-Charset: iso-8859-1, utf-8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 也可以在HTML中的META标签中设置</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;META HTTP-EQUIV=&quot;Content-Type&quot; CONTENT=&quot;text/html; charset=utf-8&quot;/&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;META LANG=&quot;cn&quot;/&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 服务器则实在Content-Type中设置</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Type: text/html ;charset: utf-8   # 表示用utf-8解码算法解码内容的二进制值</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>字符集：HTTP字符集的值说明如何吧实体内容的二进制码转换为特定的字母表中的字符</p><blockquote><p>字符集标记在由<a href="https://www.iana.org/assignments/character-sets/character-sets.xhtml" target="_blank" rel="noopener noreferrer">IANA</a>维护</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第十七章-内容协商与转码"></a>第十七章 内容协商与转码<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第十七章-内容协商与转码" title="Direct link to heading">#</a></h2><p>内容协商</p><ul><li>客户端驱动的协商 （多次请求、需要多个URI、繁琐）</li><li>服务器驱动的协商（1 根据客户端Accept首部集响应对应内容 2 根据其他首部进行变通，如浏览器提供的user-agent）</li></ul><p>内容协商首部</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 客户端                        # 服务器</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Accept                         Content-Type</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Accept-Language                Content-Language </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Accept-Charset                 Content-Type</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Accept-Encoding                Content-Encoding</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 由于http是无状态的（不会在不同请求之间zuiz）</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第五部分-内容分发与发布"></a>第五部分 内容分发与发布<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第五部分-内容分发与发布" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第十八章-主机托管服务（云服务）"></a>第十八章 主机托管服务（云服务）<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第十八章-主机托管服务（云服务）" title="Direct link to heading">#</a></h2><p>上云
镜像集群（更可靠）
内容分发网络（CDN）</p><ul><li>CDN中的反向代理缓存</li><li>CDN中的代理缓存</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第十九章-发布系统"></a>第十九章 发布系统<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第十九章-发布系统" title="Direct link to heading">#</a></h2><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="第二十章-重定向和与负载均衡"></a>第二十章 重定向和与负载均衡<a aria-hidden="true" tabindex="-1" class="hash-link" href="#第二十章-重定向和与负载均衡" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">HTTP重定向</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DNS重定向</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">任播路由</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">策略路由</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">IP MAC转发</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">IP地址转发</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">WCCP Web缓存协调协议</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ICP 缓存通信协议</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">HTCP 超文本缓存协议</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">NECP 网元控制协议</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CARP 缓存阵列路由协议</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">WPAD Web代理自动发现协议</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="日志记录与使用情况"></a>日志记录与使用情况<a aria-hidden="true" tabindex="-1" class="hash-link" href="#日志记录与使用情况" title="Direct link to heading">#</a></h2></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#第一章-http概述" class="table-of-contents__link">第一章 HTTP概述</a></li><li><a href="#第二章-url与资源" class="table-of-contents__link">第二章 URL与资源</a></li><li><a href="#第三章-http报文" class="table-of-contents__link">第三章 HTTP报文</a></li><li><a href="#第四章-连接管理" class="table-of-contents__link">第四章 连接管理</a></li><li><a href="#第五章-web服务器结构" class="table-of-contents__link">第五章 web服务器结构</a></li><li><a href="#第六章-http代理服务器" class="table-of-contents__link">第六章 http代理服务器</a></li><li><a href="#第七章-web缓存机制" class="table-of-contents__link">第七章 web缓存机制</a></li><li><a href="#第八章-集成点：网关、隧道及中继" class="table-of-contents__link">第八章　集成点：网关、隧道及中继</a></li><li><a href="#第九章-web机器人（爬虫）" class="table-of-contents__link">第九章　web机器人（爬虫）</a></li><li><a href="#第十章-web技术的未来" class="table-of-contents__link">第十章　web技术的未来</a></li><li><a href="#第十一章-客户端识别与cookie机制" class="table-of-contents__link">第十一章 客户端识别与cookie机制</a></li><li><a href="#第十二章-基本认证机制" class="table-of-contents__link">第十二章 基本认证机制</a></li><li><a href="#第十三章-摘要认证" class="table-of-contents__link">第十三章 摘要认证</a></li><li><a href="#第十四章-https" class="table-of-contents__link">第十四章 HTTPS</a></li><li><a href="#第十五章-实体和编码" class="table-of-contents__link">第十五章 实体和编码</a></li><li><a href="#第十六章-国际化" class="table-of-contents__link">第十六章 国际化</a></li><li><a href="#第十七章-内容协商与转码" class="table-of-contents__link">第十七章 内容协商与转码</a></li><li><a href="#第十八章-主机托管服务（云服务）" class="table-of-contents__link">第十八章 主机托管服务（云服务）</a></li><li><a href="#第十九章-发布系统" class="table-of-contents__link">第十九章 发布系统</a></li><li><a href="#第二十章-重定向和与负载均衡" class="table-of-contents__link">第二十章 重定向和与负载均衡</a></li><li><a href="#日志记录与使用情况" class="table-of-contents__link">日志记录与使用情况</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div>Copyright © 2020 LeoY233. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.da09b0aa.js"></script>
<script src="/runtime~main.872dded8.js"></script>
<script src="/main.2f1d5848.js"></script>
<script src="/1.f45b894e.js"></script>
<script src="/2.a477ba05.js"></script>
<script src="/3.b78202e8.js"></script>
<script src="/1be78505.89b8407a.js"></script>
<script src="/171.d3ef19ea.js"></script>
<script src="/935f2afb.43a6fc9a.js"></script>
<script src="/17896441.30e2172e.js"></script>
<script src="/36faa5d6.be2c1bec.js"></script>
</body>
</html>